#include <SoftwareSerial.h>
#include <Servo.h>


Servo servo;  // create servo object to control a servo
int motion = 2;
int light = 12;
int servoPin = 4;
int buzzer = 9;
int angle = 0;

SoftwareSerial xbee(1, 2);


#define RLOAD 10.0
#define RZERO 76.63
#define PARA 116.6020682
#define PARB 2.769034857

void setup() {
	pinMode(motion, INPUT);
	pinMode(buzzer, OUTPUT);
	pinMode(light, OUTPUT);
	servo.attach(servoPin);

	xbee.begin(9600);
}

void loop() {

	digitalWrite(light, LOW);
	digitalWrite(buzzer, HIGH);
	servo.write(0);
	delay(15);

	int sensor = digitalRead(motion);

	if (sensor == HIGH) {
		digitalWrite(light, HIGH);
		digitalWrite(buzzer, LOW);
		for (angle = 0; angle < 90; angle++)
		{
			servo.write(angle);
			delay(15);
		}
		delay(2500);
	}

	if (xbee.available())
	{
		switch (xbee.read())
		{
		case 'R':
			for (angle = 0; angle <= 90; angle += 1) { // goes from 0 degrees to 180 degrees
												 // in steps of 1 degree
				servo.write(angle);              // tell servo to go to position in variable 'pos'
				delay(15);                       // waits 15ms for the servo to reach the position
			}
			break;

		case 'T':
			for (angle = 90; angle >= 0; angle -= 1) { // goes from 180 degrees to 0 degrees
				servo.write(angle);              // tell servo to go to position in variable 'pos'
				delay(15);                       // waits 15ms for the servo to reach the position
			}
			break;
		}
	}
}
